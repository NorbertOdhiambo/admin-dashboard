{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/HP/Desktop/dashboard/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/HP/Desktop/dashboard/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/HP/Desktop/dashboard/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createContext,useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";export var UserContext=/*#__PURE__*/createContext();export var Axios=axios.create({// baseURL: 'http://localhost:8000/api_dashb/',\nbaseURL:'https://graduate-essay-helpers.com/api_dashb/'});export var UserContextProvider=function UserContextProvider(_ref){var children=_ref.children;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),theUser=_useState2[0],setUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),wait=_useState4[0],setWait=_useState4[1];var registerUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref2){var first_name,last_name,email,username,password,_yield$Axios$post,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:first_name=_ref2.first_name,last_name=_ref2.last_name,email=_ref2.email,username=_ref2.username,password=_ref2.password;setWait(true);_context.prev=2;_context.next=5;return Axios.post('register.php',{first_name:first_name,last_name:last_name,email:email,username:username,password:password});case 5:_yield$Axios$post=_context.sent;data=_yield$Axios$post.data;setWait(false);return _context.abrupt(\"return\",data);case 11:_context.prev=11;_context.t0=_context[\"catch\"](2);setWait(false);return _context.abrupt(\"return\",{success:0,message:'Server Error!'});case 15:case\"end\":return _context.stop();}}},_callee,null,[[2,11]]);}));return function registerUser(_x){return _ref3.apply(this,arguments);};}();var loginUser=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref4){var email,password,_yield$Axios$post2,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:email=_ref4.email,password=_ref4.password;setWait(true);_context2.prev=2;_context2.next=5;return Axios.post('login.php',{email:email,password:password});case 5:_yield$Axios$post2=_context2.sent;data=_yield$Axios$post2.data;if(!(data.success&&data.token)){_context2.next=11;break;}localStorage.setItem('loginToken',data.token);setWait(false);return _context2.abrupt(\"return\",{success:1});case 11:setWait(false);return _context2.abrupt(\"return\",{success:0,message:data.message});case 15:_context2.prev=15;_context2.t0=_context2[\"catch\"](2);setWait(false);return _context2.abrupt(\"return\",{success:0,message:'Server Error!'});case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[2,15]]);}));return function loginUser(_x2){return _ref5.apply(this,arguments);};}();var loggedInCheck=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var loginToken,_yield$Axios$get,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:loginToken=localStorage.getItem('loginToken');Axios.defaults.headers.common['Authorization']='Bearer '+loginToken;if(!loginToken){_context3.next=11;break;}_context3.next=5;return Axios.get('getUser.php');case 5:_yield$Axios$get=_context3.sent;data=_yield$Axios$get.data;if(!(data.success&&data.user)){_context3.next=10;break;}setUser(data.user);return _context3.abrupt(\"return\");case 10:setUser(null);case 11:case\"end\":return _context3.stop();}}},_callee3);}));return function loggedInCheck(){return _ref6.apply(this,arguments);};}();useEffect(function(){function asyncCall(){return _asyncCall.apply(this,arguments);}function _asyncCall(){_asyncCall=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return loggedInCheck();case 2:case\"end\":return _context4.stop();}}},_callee4);}));return _asyncCall.apply(this,arguments);}asyncCall();},[]);var logout=function logout(){localStorage.removeItem('loginToken');setUser(null);};return/*#__PURE__*/_jsx(UserContext.Provider,{value:{registerUser:registerUser,loginUser:loginUser,wait:wait,user:theUser,loggedInCheck:loggedInCheck,logout:logout},children:children});};export default UserContextProvider;","map":{"version":3,"names":["createContext","useState","useEffect","axios","UserContext","Axios","create","baseURL","UserContextProvider","children","theUser","setUser","wait","setWait","registerUser","first_name","last_name","email","username","password","post","data","success","message","loginUser","token","localStorage","setItem","loggedInCheck","loginToken","getItem","defaults","headers","common","get","user","asyncCall","logout","removeItem"],"sources":["C:/Users/HP/Desktop/dashboard/src/context/UserContext.js"],"sourcesContent":["import { createContext, useState, useEffect } from 'react'\r\nimport axios from 'axios'\r\n\r\nexport const UserContext = createContext();\r\n\r\nexport const Axios = axios.create({\r\n    // baseURL: 'http://localhost:8000/api_dashb/',\r\n    baseURL: 'https://graduate-essay-helpers.com/api_dashb/',\r\n});\r\n\r\nexport const UserContextProvider = ({ children }) => {\r\n\r\n    const [theUser, setUser] = useState(null);\r\n    const [wait, setWait] = useState(false);\r\n\r\n    const registerUser = async ({ first_name, last_name, email, username, password }) => {\r\n        setWait(true);\r\n        try {\r\n            const { data } = await Axios.post('register.php', {\r\n                first_name,\r\n                last_name,\r\n                email,\r\n                username,\r\n                password\r\n            });\r\n            setWait(false);\r\n            return data;\r\n        }\r\n        catch (err) {\r\n            setWait(false);\r\n            return { success: 0, message: 'Server Error!' };\r\n        }\r\n    }\r\n\r\n    const loginUser = async ({ email, password }) => {\r\n        setWait(true);\r\n        try {\r\n            const { data } = await Axios.post('login.php', {\r\n                email,\r\n                password\r\n            });\r\n            if (data.success && data.token) {\r\n                localStorage.setItem('loginToken', data.token);\r\n                setWait(false);\r\n                return { success: 1 };\r\n            }\r\n            setWait(false);\r\n            return { success: 0, message: data.message };\r\n        }\r\n        catch (err) {\r\n            setWait(false);\r\n            return { success: 0, message: 'Server Error!' };\r\n        }\r\n\r\n    }\r\n\r\n    const loggedInCheck = async () => {\r\n        const loginToken = localStorage.getItem('loginToken');\r\n        Axios.defaults.headers.common['Authorization'] = 'Bearer ' + loginToken;\r\n        if (loginToken) {\r\n            const { data } = await Axios.get('getUser.php');\r\n            if (data.success && data.user) {\r\n                setUser(data.user);\r\n                return;\r\n            }\r\n            setUser(null);\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        async function asyncCall() {\r\n            await loggedInCheck();\r\n        }\r\n        asyncCall();\r\n    }, []);\r\n\r\n    const logout = () => {\r\n        localStorage.removeItem('loginToken');\r\n        setUser(null);\r\n    }\r\n\r\n    return (\r\n        <UserContext.Provider value={{ registerUser, loginUser, wait, user: theUser, loggedInCheck, logout }}>\r\n            {children}\r\n        </UserContext.Provider>\r\n    );\r\n\r\n}\r\n\r\nexport default UserContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}